<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Протокол потоковой репликации</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="Документация по PostgreSQL 9.4.1"
HREF="index.html"><LINK
REL="UP"
TITLE="Клиент-серверный протокол"
HREF="protocol.html"><LINK
REL="PREVIOUS"
TITLE="Поток сообщений"
HREF="protocol-flow.html"><LINK
REL="NEXT"
TITLE="Типы данных в сообщениях"
HREF="protocol-message-types.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=UTF-8"><META
NAME="creation"
CONTENT="2016-04-12T07:56:57"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>Документация по PostgreSQL 9.4.1</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="Поток сообщений"
HREF="protocol-flow.html"
ACCESSKEY="P"
>Пред.</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="protocol.html"
ACCESSKEY="U"
>Уровень выше</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>Глава 49. Клиент-серверный протокол</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="Типы данных в сообщениях"
HREF="protocol-message-types.html"
ACCESSKEY="N"
>След.</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="PROTOCOL-REPLICATION"
>49.3. Протокол потоковой репликации</A
></H1
><P
>Чтобы инициировать потоковую репликацию, клиент передаёт в стартовом сообщении параметр <TT
CLASS="LITERAL"
>replication</TT
>. Логическое значение <TT
CLASS="LITERAL"
>true</TT
> этого параметра указывает обслуживающему процессу перейти в режим передачи WAL (walsender), в котором вместо SQL-операторов клиент может выдавать только ограниченный набор команд репликации. В режиме walsender можно использовать только протокол простых запросов. Если этот параметр имеет значение <TT
CLASS="LITERAL"
>database</TT
>, процесс walsender должен подключиться к базе данных, указанной в параметре <TT
CLASS="LITERAL"
>dbname</TT
>, что позволит использовать это подключение для логической репликации с указанной базой данных.</P
><P
>Для целей тестирования команд репликации вы можете установить соединение для репликации через <SPAN
CLASS="APPLICATION"
>psql</SPAN
> или любую другую программу на базе <TT
CLASS="LITERAL"
>libpq</TT
> со строкой подключения, включающей параметр <TT
CLASS="LITERAL"
>replication</TT
>, например так: </P><PRE
CLASS="PROGRAMLISTING"
>psql "dbname=postgres replication=database" -c "IDENTIFY_SYSTEM;"</PRE
><P> Однако часто полезнее использовать <SPAN
CLASS="APPLICATION"
>pg_receivexlog</SPAN
> (для физической репликации) или <SPAN
CLASS="APPLICATION"
>pg_recvlogical</SPAN
> (для логической репликации).</P
><P
>В режиме walsender принимаются следующие команды: <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>IDENTIFY_SYSTEM </DT
><DD
><P
>Запрашивает идентификационные данные сервера. Сервер возвращает набор результатов с одной строкой, содержащей четыре поля:</P
><P
>      <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>systemid</DT
><DD
><P
>Уникальный идентификатор системы, идентифицирующий кластер. По нему можно определить, что базовая резервная копия, из которой инициализировался резервный сервер, получена из того же кластера.</P
></DD
><DT
>timeline</DT
><DD
><P
>Идентификатор текущей линии времени. Также полезен для того, чтобы убедиться, что резервный сервер согласован с главным.</P
></DD
><DT
>xlogpos</DT
><DD
><P
>Текущее положение сохранённых данных в xlog. Позволяет узнать, с какой позиции в журнале транзакции может начаться потоковая передача.</P
></DD
><DT
>dbname</DT
><DD
><P
>Подключённая база данных или NULL.</P
></DD
></DL
></DIV
><P>
     </P
></DD
><DT
>TIMELINE_HISTORY <TT
CLASS="REPLACEABLE"
><I
>лин_врем</I
></TT
></DT
><DD
><P
>Запрашивает с сервера файл истории для линии времени <TT
CLASS="REPLACEABLE"
><I
>лин_врем</I
></TT
>. Сервер возвращает набор результатов с одной строкой, содержащей два поля:</P
><P
>      <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>filename</DT
><DD
><P
>Имя файла с историей линии времени, например <TT
CLASS="FILENAME"
>00000002.history</TT
>.</P
></DD
><DT
>content</DT
><DD
><P
>Содержимое файла с историей линией времени.</P
></DD
></DL
></DIV
><P>
     </P
></DD
><DT
>CREATE_REPLICATION_SLOT <TT
CLASS="REPLACEABLE"
><I
>имя_слота</I
></TT
> { <TT
CLASS="LITERAL"
>PHYSICAL</TT
> | <TT
CLASS="LITERAL"
>LOGICAL</TT
> <TT
CLASS="REPLACEABLE"
><I
>модуль_вывода</I
></TT
> } </DT
><DD
><P
>Создаёт слот физической или логической репликации. Слоты репликации описаны подробно в <A
HREF="warm-standby.html#STREAMING-REPLICATION-SLOTS"
>Подразделе 25.2.6</A
>.</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="REPLACEABLE"
><I
>имя_слота</I
></TT
></DT
><DD
><P
>Имя создаваемого слота. Заданное имя должно быть допустимым для слота репликации (см. <A
HREF="warm-standby.html#STREAMING-REPLICATION-SLOTS-MANIPULATION"
>Подраздел 25.2.6.1</A
>).</P
></DD
><DT
><TT
CLASS="REPLACEABLE"
><I
>модуль_вывода</I
></TT
></DT
><DD
><P
>Имя модуля вывода, применяемого для логического декодирования (см. <A
HREF="logicaldecoding-output-plugin.html"
>Раздел 46.6</A
>).</P
></DD
></DL
></DIV
></DD
><DT
>START_REPLICATION [<TT
CLASS="LITERAL"
>SLOT</TT
> <TT
CLASS="REPLACEABLE"
><I
>имя_слота</I
></TT
>] [<TT
CLASS="LITERAL"
>PHYSICAL</TT
>] <TT
CLASS="REPLACEABLE"
><I
>XXX/XXX</I
></TT
> [<TT
CLASS="LITERAL"
>TIMELINE</TT
> <TT
CLASS="REPLACEABLE"
><I
>лин_врем</I
></TT
>] </DT
><DD
><P
>Указывает серверу начать потоковую передачу WAL, начиная с позиции <TT
CLASS="REPLACEABLE"
><I
>XXX/XXX</I
></TT
> в WAL. Если указывается параметр <TT
CLASS="LITERAL"
>TIMELINE</TT
>, передача начинается на линии времени <TT
CLASS="REPLACEABLE"
><I
>лин_врем</I
></TT
>, иначе выбирается текущая линия времени сервера. Сервер может вернуть в ответ ошибку, например, если запрошенный сегмент WAL уже потерян. Если проблем не возникает, сервер возвращает сообщение CopyBothResponse, а затем начинает передавать поток WAL клиенту.</P
><P
>Если в параметрах передаётся <TT
CLASS="REPLACEABLE"
><I
>имя_слота</I
></TT
>, сервер будет отражать состояние репликации в этом слоте и отслеживать, какие сегменты, а если включён режим <TT
CLASS="VARNAME"
>hot_standby_feedback</TT
>, то и в каких транзакциях, всё ещё нужны этому резервному серверу.</P
><P
>Если клиент запрашивает не последнюю, но существующую в истории сервера линию времени, сервер будет передавать весь WAL на этой линии времени, начиная с запрошенной стартовой точки до момента, когда сервер переключился на другую линию времени. Если клиент запрашивает передачу с начальной позицией точно в конце старой линии времени, сервер немедленно отвечает CommandComplete, не переходя в режим COPY.</P
><P
>После передачи всех записей WAL на линии времени, не являющейся текущей, сервер завершает потоковую передачу, выходя из режима копирования. Когда клиент подтверждает завершение передачи, также выходя из режима копирования, сервер возвращает набор результатов с одной строкой и двумя колонками, сообщая таким образом о следующей линии времени в истории сервера. В первой колонке передаётся идентификатор следующей линии времени, а во второй — позиция в XLOG, в которой произошло переключение. Обычно в этой же позиции завершается передача потока WAL, но возможны исключения, когда сервер может передавать записи WAL из старой линии времени, которые он сам ещё не воспроизвёл до переключения. Наконец сервер передаёт сообщение CommandComplete, после чего он готов принять следующую команду.</P
><P
>Данные WAL передаются в серии сообщений CopyData. (Это позволяет перемежать их с другой информацией; в частности, сервер может передать сообщение ErrorResponse, если он столкнулся с проблемами, уже начав передачу потока.) Полезная нагрузка каждого сообщения CopyData от сервера к клиенту содержит данные в одном из следующих форматов:</P
><P
>      <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>XLogData (B) — данные журнала транзакций</DT
><DD
><P
>      <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>Byte1('w')</DT
><DD
><P
>Указывает, что в этом сообщении передаются данные WAL.</P
></DD
><DT
>Int64</DT
><DD
><P
>Начальная точка данных WAL в этом сообщении.</P
></DD
><DT
>Int64</DT
><DD
><P
>Текущее положение конца WAL на сервере.</P
></DD
><DT
>Int64</DT
><DD
><P
>Показания системных часов сервера в момент передачи, в микросекундах с полуночи 2000-01-01.</P
></DD
><DT
>Byte<TT
CLASS="REPLACEABLE"
><I
>n</I
></TT
></DT
><DD
><P
>Фрагмент потока данных WAL.</P
><P
>Одна запись WAL никогда не разделяется на два сообщения XLogData. Когда запись WAL пересекает границу страницы WAL, и таким образом от неё уже оказывается отделена продолжающая запись, её можно разделить на сообщения по границе страницы. Другими словами, первая основная запись WAL и продолжающие её записи могут быть переданы в различных сообщениях XLogData.</P
></DD
></DL
></DIV
><P>
      </P
></DD
><DT
>Primary keepalive message (B) — Сообщение об активности ведущего</DT
><DD
><P
>      <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>Byte1('k')</DT
><DD
><P
>Указывает, что это сообщение об активности отправителя.</P
></DD
><DT
>Int64</DT
><DD
><P
>Текущее положение конца WAL на сервере.</P
></DD
><DT
>Int64</DT
><DD
><P
>Показания системных часов сервера в момент передачи, в микросекундах с полуночи 2000-01-01.</P
></DD
><DT
>Byte1</DT
><DD
><P
>Значение 1 означает, что клиент должен ответить на это сообщение как можно скорее, во избежание отключения по таймауту. Со значением 0 это не требуется.</P
></DD
></DL
></DIV
><P>
      </P
></DD
></DL
></DIV
><P>
     </P
><P
>Принимающий процесс может передавать ответы отправителю в любое время, используя один из следующих форматов данных (также в полезной нагрузке сообщения CopyData):</P
><P
>      <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>Standby status update (F) — Обновление состояния резервного сервера</DT
><DD
><P
>      <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>Byte1('r')</DT
><DD
><P
>Указывает, что это сообщение передаёт обновлённое состояние получателя.</P
></DD
><DT
>Int64</DT
><DD
><P
>Положение следующего за последним байтом WAL, полученным и записанным на диск на резервном сервере.</P
></DD
><DT
>Int64</DT
><DD
><P
>Положение следующего за последним байтом WAL, сохранённым на диске на резервном сервере.</P
></DD
><DT
>Int64</DT
><DD
><P
>Положение следующего за последним байтом WAL, применённым на резервном сервере.</P
></DD
><DT
>Int64</DT
><DD
><P
>Показания системных часов клиента в момент передачи, в микросекундах с полуночи 2000-01-01.</P
></DD
><DT
>Byte1</DT
><DD
><P
>Если содержит 1, клиент запрашивает от сервера немедленный ответ на это сообщение. Так клиент может запросить отклик сервера и проверить, продолжает ли функционировать соединение.</P
></DD
></DL
></DIV
><P>
      </P
></DD
></DL
></DIV
><P>
     </P
><P
>      <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>Hot Standby feedback message (F) — Сообщение обратной связи горячего резерва</DT
><DD
><P
>      <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>Byte1('h')</DT
><DD
><P
>Указывает, что это сообщение обратной связи горячего резерва.</P
></DD
><DT
>Int64</DT
><DD
><P
>Показания системных часов клиента в момент передачи, в микросекундах с полуночи 2000-01-01.</P
></DD
><DT
>Int32</DT
><DD
><P
>Текущее значение xmin данного резервного сервера. Может быть нулевым; это означает, что резервный сервер уведомляет о том, что сообщения обратной связи горячего резерва больше не будут передаваться через это подключение. Последующие ненулевые значения могут восстановить работу механизма обратной связи.</P
></DD
><DT
>Int32</DT
><DD
><P
>Текущая эпоха резервного сервера.</P
></DD
></DL
></DIV
><P>
      </P
></DD
></DL
></DIV
><P>
     </P
></DD
><DT
>START_REPLICATION <TT
CLASS="LITERAL"
>SLOT</TT
> <TT
CLASS="REPLACEABLE"
><I
>имя_слота</I
></TT
> <TT
CLASS="LITERAL"
>LOGICAL</TT
> <TT
CLASS="REPLACEABLE"
><I
>XXX/XXX</I
></TT
> [ ( <TT
CLASS="REPLACEABLE"
><I
>имя_параметра</I
></TT
> [<TT
CLASS="REPLACEABLE"
><I
>значение_параметра</I
></TT
>] [, ... ] ) ]</DT
><DD
><P
>Указывает серверу начать потоковую передачу WAL для логической репликации, начиная с позиции <TT
CLASS="REPLACEABLE"
><I
>XXX/XXX</I
></TT
> в WAL. Сервер может вернуть в ответ ошибку, например, если запрошенный сегмент WAL уже потерян. Если проблем не возникает, сервер возвращает сообщение CopyBothResponse, а затем начинает передавать поток WAL клиенту.</P
><P
>Данные, передаваемые внутри сообщений CopyBothResponse, имеют тот же формат, что описан для команды <TT
CLASS="LITERAL"
>START_REPLICATION ... PHYSICAL</TT
>.</P
><P
>Обработку выводимых данных для передачи выполняет модуль вывода, связанный с выбранным слотом.</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="LITERAL"
>SLOT</TT
> <TT
CLASS="REPLACEABLE"
><I
>имя_слота</I
></TT
></DT
><DD
><P
>Имя слота, из которого передаются изменения. Это имя является обязательным, оно должно соответствовать существующему логическому слоту репликации, созданному командой <TT
CLASS="LITERAL"
>CREATE_REPLICATION_SLOT</TT
> в режиме <TT
CLASS="LITERAL"
>LOGICAL</TT
>.</P
></DD
><DT
><TT
CLASS="REPLACEABLE"
><I
>XXX/XXX</I
></TT
></DT
><DD
><P
>Позиция в WAL, с которой должна начаться передача.</P
></DD
><DT
><TT
CLASS="REPLACEABLE"
><I
>имя_параметра</I
></TT
></DT
><DD
><P
>Имя параметра, передаваемого модулю логического декодирования для выбранного слота.</P
></DD
><DT
><TT
CLASS="REPLACEABLE"
><I
>значение_параметра</I
></TT
></DT
><DD
><P
>Необязательное значение, в форме строковой константы, связываемое с указанным параметром.</P
></DD
></DL
></DIV
></DD
><DT
>DROP_REPLICATION_SLOT <TT
CLASS="REPLACEABLE"
><I
>имя_слота</I
></TT
></DT
><DD
><P
>Удаляет слот репликации, что приводит к освобождению всех зарезервированных для него ресурсов на стороне сервера. Если слот в настоящий момент используется активным соединением, команда завершается ошибкой.</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="REPLACEABLE"
><I
>имя_слота</I
></TT
></DT
><DD
><P
>Имя слота, подлежащего удалению.</P
></DD
></DL
></DIV
></DD
><DT
>BASE_BACKUP [<TT
CLASS="LITERAL"
>LABEL</TT
> <TT
CLASS="REPLACEABLE"
><I
>'метка'</I
></TT
>] [<TT
CLASS="LITERAL"
>PROGRESS</TT
>] [<TT
CLASS="LITERAL"
>FAST</TT
>] [<TT
CLASS="LITERAL"
>WAL</TT
>] [<TT
CLASS="LITERAL"
>NOWAIT</TT
>] [<TT
CLASS="LITERAL"
>MAX_RATE</TT
> <TT
CLASS="REPLACEABLE"
><I
>скорость</I
></TT
>] </DT
><DD
><P
>Указывает серверу начать потоковую передачу базовой копии. Система автоматически переходит в режим резервного копирования до начала передачи, и выходит из него после завершения копирования. Эта команда принимает следующие параметры: <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="LITERAL"
>LABEL</TT
> <TT
CLASS="REPLACEABLE"
><I
>'метка'</I
></TT
></DT
><DD
><P
>Устанавливает метку для резервной копии. Если метка не задана, по умолчанию устанавливается метка <TT
CLASS="LITERAL"
>base backup</TT
>. Для метки действуют те же правила применения кавычек, что и для стандартных строк SQL при включённым режиме <A
HREF="runtime-config-compatible.html#GUC-STANDARD-CONFORMING-STRINGS"
>standard_conforming_strings</A
>.</P
></DD
><DT
><TT
CLASS="LITERAL"
>PROGRESS</TT
></DT
><DD
><P
>Запрашивает информацию, необходимую для отслеживания прогресса операции. Сервер передаёт в ответ приблизительный размер в заголовке каждого табличного пространства, исходя из которого можно понять, насколько продвинулась передача потока. Для вычисления этого размера анализируются размеры всех файлов ещё до начала передачи, и это может негативно повлиять на производительность — в частности, может увеличиться задержка до передачи первых данных. Так как файлы базы данных могут меняться во время резервного копирования, оценка размера не будет точной; размер базы может увеличиться или уменьшиться за время от вычисления этой оценки до передачи актуальных файлов.</P
></DD
><DT
><TT
CLASS="LITERAL"
>FAST</TT
></DT
><DD
><P
>Запрашивает быструю контрольную точку.</P
></DD
><DT
><TT
CLASS="LITERAL"
>WAL</TT
></DT
><DD
><P
>Включает в резервную копию необходимые сегменты WAL. При этом в подкаталог <TT
CLASS="FILENAME"
>pg_xlog</TT
> архива базового каталога будут включены все файлы с начала до конца копирования.</P
></DD
><DT
><TT
CLASS="LITERAL"
>NOWAIT</TT
></DT
><DD
><P
>По умолчанию при копировании ожидается завершение архивации последнего требуемого сегмента xlog, либо выдаётся предупреждение, если архивация журнала не включена. Указание <TT
CLASS="LITERAL"
>NOWAIT</TT
> отключает и ожидание, и предупреждение, так что обеспечение наличия требуемого журнала становится задачей клиента.</P
></DD
><DT
><TT
CLASS="LITERAL"
>MAX_RATE</TT
> <TT
CLASS="REPLACEABLE"
><I
>скорость передачи</I
></TT
></DT
><DD
><P
>Ограничивает (сдерживает) максимальный объём данных, передаваемый от сервера клиенту за единицу времени. Единица измерения этого параметра — килобайты в секунду. Если задаётся этот параметр, его значение должно быть равно нулю, либо должно находиться в диапазоне от 32 (килобайт/сек) до 1 Гбайта/сек (включая границы). Если передаётся ноль, либо параметр не задаётся, скорость передачи не ограничивается.</P
></DD
></DL
></DIV
><P></P
><P
>Когда запускается копирование, сервер сначала передаёт два обычных набора результатов, за которыми следуют один или более результатов CopyResponse.</P
><P
>В первом обычном наборе результатов передаётся начальная позиция резервной копии, в одной строке с двумя колонками. В первой колонке содержится стартовая позиция в формате XLogRecPtr, а во второй идентификатор соответствующей линии времени.</P
><P
>Во втором обычном наборе результатов передаётся по одной строке для каждого табличного пространства. Эта строка содержит следующие поля: <P
></P
></P><DIV
CLASS="VARIABLELIST"
><DL
><DT
>spcoid</DT
><DD
><P
>OID табличного пространства, либо <TT
CLASS="LITERAL"
>NULL</TT
>, если это базовый каталог.</P
></DD
><DT
>spclocation</DT
><DD
><P
>Полный путь к каталогу табличного пространства, либо <TT
CLASS="LITERAL"
>NULL</TT
>, если это базовый каталог.</P
></DD
><DT
>size</DT
><DD
><P
>Приблизительный размер табличного пространства, если была запрошена информация о прогрессе операции; в противном случае <TT
CLASS="LITERAL"
>NULL</TT
>.</P
></DD
></DL
></DIV
><P></P
><P
>За вторым обычным набором результатов следует одна или несколько серий результатов CopyResponse, одна для PGDATA и по одной для каждого табличного пространства, отличного от <TT
CLASS="LITERAL"
>pg_default</TT
> и <TT
CLASS="LITERAL"
>pg_global</TT
>. Данные в CopyResponse представляют собой выгруженное в формате tar (<SPAN
CLASS="QUOTE"
>"формате обмена ustar"</SPAN
>, описанном в стандарте POSIX 1003.1-2008) содержимое табличных пространств, за исключением того, что два замыкающих блока нулей, описанных в стандарте, не передаются. После завершения передачи данных tar, передаётся конечный обычный набор результатов, в котором сообщается конечная позиция копии в WAL, в том же формате, что и стартовая позиция.</P
><P
>Архив tar каталога данных и всех табличных пространств будет содержать все файлы в этих каталогах, будь то файлы <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> или посторонние файлы, добавленные в эти каталоги. Исключение составляют только следующие файлы: <P
></P
></P><UL
COMPACT="COMPACT"
><LI
STYLE="list-style-type: disc"
><P
>         <TT
CLASS="FILENAME"
>postmaster.pid</TT
>
        </P
></LI
><LI
STYLE="list-style-type: disc"
><P
>         <TT
CLASS="FILENAME"
>postmaster.opts</TT
>
        </P
></LI
><LI
STYLE="list-style-type: disc"
><P
>различные временные файлы, создаваемые в процессе работы сервером PostgreSQL</P
></LI
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="FILENAME"
>pg_xlog</TT
>, включая подкаталоги. Если в резервную копию включаются файлы WAL, в архив входит преобразованная версия <TT
CLASS="FILENAME"
>pg_xlog</TT
>, в которой будут находиться только файлы, необходимые для восстановления копии, но не всё остальное содержимое этого каталога.</P
></LI
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="FILENAME"
>pg_replslot</TT
> копируется в виде пустого каталога.</P
></LI
><LI
STYLE="list-style-type: disc"
><P
>файлы, отличные от обычных файлов и каталогов, например, символические ссылки и файлы специальных устройств, пропускаются. (Символические ссылки в <TT
CLASS="FILENAME"
>pg_tblspc</TT
> сохраняются.)</P
></LI
></UL
><P> Если файловая система сервера поддерживает это, в архив включается информация о владельце, группе и режиме файла.</P
><P
>После передачи табличных пространств передаётся конечный обычный набор результатов. Этот набор состоит из одной строки с единственной колонкой, содержащей конечную позиции копии в формате XLogRecPtr.</P
></DD
></DL
></DIV
><P></P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="protocol-flow.html"
ACCESSKEY="P"
>Пред.</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Начало</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="protocol-message-types.html"
ACCESSKEY="N"
>След.</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Поток сообщений</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="protocol.html"
ACCESSKEY="U"
>Уровень выше</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Типы данных в сообщениях</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>