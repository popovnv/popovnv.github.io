<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Функции и операторы для работы с массивами</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="Документация по PostgreSQL 9.4.1"
HREF="index.html"><LINK
REL="UP"
TITLE="Функции и операторы"
HREF="functions.html"><LINK
REL="PREVIOUS"
TITLE="Условные выражения"
HREF="functions-conditional.html"><LINK
REL="NEXT"
TITLE="Диапазонные функции и операторы"
HREF="functions-range.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=UTF-8"><META
NAME="creation"
CONTENT="2016-04-12T07:56:57"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>Документация по PostgreSQL 9.4.1</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="Условные выражения"
HREF="functions-conditional.html"
ACCESSKEY="P"
>Пред.</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="functions.html"
ACCESSKEY="U"
>Уровень выше</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>Глава 9. Функции и операторы</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="Диапазонные функции и операторы"
HREF="functions-range.html"
ACCESSKEY="N"
>След.</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="FUNCTIONS-ARRAY"
>9.18. Функции и операторы для работы с массивами</A
></H1
><P
>В <A
HREF="functions-array.html#ARRAY-OPERATORS-TABLE"
>Таблице 9-45</A
> показаны операторы, предназначенные для работы с массивами.</P
><DIV
CLASS="TABLE"
><A
NAME="ARRAY-OPERATORS-TABLE"
></A
><P
><B
>Таблица 9-45. Операторы для работы с массивами</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><COL><THEAD
><TR
><TH
>Оператор</TH
><TH
>Описание</TH
><TH
>Пример</TH
><TH
>Результат</TH
></TR
></THEAD
><TBODY
><TR
><TD
> <TT
CLASS="LITERAL"
>=</TT
> </TD
><TD
>равно</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1.1,2.1,3.1]​::int[] = ARRAY[1,2,3]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>t</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>&lt;&gt;</TT
> </TD
><TD
>не равно</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1,2,3] &lt;&gt; ARRAY[1,2,4]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>t</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>&lt;</TT
> </TD
><TD
>меньше</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1,2,3] &lt; ARRAY[1,2,4]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>t</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>&gt;</TT
> </TD
><TD
>больше</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1,4,3] &gt; ARRAY[1,2,4]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>t</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>&lt;=</TT
> </TD
><TD
>меньше или равно</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1,2,3] &lt;= ARRAY[1,2,3]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>t</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>&gt;=</TT
> </TD
><TD
>больше или равно</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1,4,3] &gt;= ARRAY[1,4,3]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>t</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>@&gt;</TT
> </TD
><TD
>содержит</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1,4,3] @&gt; ARRAY[3,1]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>t</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>&lt;@</TT
> </TD
><TD
>содержится в</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[2,7] &lt;@ ARRAY[1,7,4,2,6]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>t</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>&amp;&amp;</TT
> </TD
><TD
>пересечение (есть общие элементы)</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1,4,3] &amp;&amp; ARRAY[2,1]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>t</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>||</TT
> </TD
><TD
>соединение массива с массивом</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1,2,3] || ARRAY[4,5,6]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{1,2,3,4,5,6}</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>||</TT
> </TD
><TD
>соединение массива с массивом</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[1,2,3] || ARRAY[[4,5,6], [7,8,9]]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{{1,2,3},{4,5,6},​{7,8,9}}</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>||</TT
> </TD
><TD
>соединение элемента с массивом</TD
><TD
>                  <TT
CLASS="LITERAL"
>3 || ARRAY[4,5,6]</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{3,4,5,6}</TT
>
                </TD
></TR
><TR
><TD
> <TT
CLASS="LITERAL"
>||</TT
> </TD
><TD
>соединение массива с элементом</TD
><TD
>                  <TT
CLASS="LITERAL"
>ARRAY[4,5,6] || 7</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{4,5,6,7}</TT
>
                </TD
></TR
></TBODY
></TABLE
></DIV
><P
>Операторы сравнения массивов сравнивают содержимое массивов по элементам, используя при этом функцию сравнения для B-дерева, определённую для типа данного элемента по умолчанию. В многомерных массивах элементы просматриваются по строкам (индекс последней размерности меняется в первую очередь). Если содержимое двух массивов совпадает, а размерности различаются, результат их сравнения будет определяться первым отличием в размерностях. (В <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> до версии 8.2 поведение было другим: два массива с одинаковым содержимом считались одинаковыми, даже если число их размерностей и границы индексов различались.)</P
><P
>Подробнее поведение операторов с массивами описано в <A
HREF="arrays.html"
>Разделе 8.15</A
>. За дополнительными сведениями об операторах, поддерживающих индексы, обратитесь к <A
HREF="indexes-types.html"
>Разделу 11.2</A
>.</P
><P
>В <A
HREF="functions-array.html#ARRAY-FUNCTIONS-TABLE"
>Таблице 9-46</A
> перечислены функции, предназначенные для работы с массивами. Дополнительная информация о них и примеры использования приведены в <A
HREF="arrays.html"
>Разделе 8.15</A
>.</P
><DIV
CLASS="TABLE"
><A
NAME="ARRAY-FUNCTIONS-TABLE"
></A
><P
><B
>Таблица 9-46. Функции для работы с массивами</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><COL><COL><THEAD
><TR
><TH
>Функция</TH
><TH
>Тип результата</TH
><TH
>Описание</TH
><TH
>Пример</TH
><TH
>Результат</TH
></TR
></THEAD
><TBODY
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_append</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>, <TT
CLASS="TYPE"
>anyelement</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>anyarray</TT
>
                </TD
><TD
>добавляет элемент в конец массива</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_append(​ARRAY[1,2], 3)</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{1,2,3}</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_cat</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>, <TT
CLASS="TYPE"
>anyarray</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>anyarray</TT
>
                </TD
><TD
>соединяет два массива</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_cat(​ARRAY[1,2,3], ARRAY[4,5])</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{1,2,3,4,5}</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_ndims</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>int</TT
>
                </TD
><TD
>возвращает число размерностей массива</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_ndims(​ARRAY[[1,2,3], [4,5,6]])</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>2</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_dims</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>text</TT
>
                </TD
><TD
>возвращает текстовое представление размерностей массива</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_dims(​ARRAY[[1,2,3], [4,5,6]])</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>[1:2][1:3]</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_fill</CODE
>(​<TT
CLASS="TYPE"
>anyelement</TT
>, <TT
CLASS="TYPE"
>int[]</TT
>, [<SPAN
CLASS="OPTIONAL"
>, <TT
CLASS="TYPE"
>int[]</TT
></SPAN
>])</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>anyarray</TT
>
                </TD
><TD
>возвращает массив, заполненный заданным значением и имеющий указанные размерности, в которых нижняя граница может быть отлична от 1</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_fill(7, ARRAY[3], ARRAY[2])</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>[2:4]={7,7,7}</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_length</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>, <TT
CLASS="TYPE"
>int</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>int</TT
>
                </TD
><TD
>возвращает длину указанной размерности массива</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_length(​array[1,2,3], 1)</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>3</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_lower</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>, <TT
CLASS="TYPE"
>int</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>int</TT
>
                </TD
><TD
>возвращает нижнюю границу указанной размерности массива</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_lower(​'[0:2]=​{1,2,3}'​::int[], 1)</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>0</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_prepend</CODE
>(​<TT
CLASS="TYPE"
>anyelement</TT
>, <TT
CLASS="TYPE"
>anyarray</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>anyarray</TT
>
                </TD
><TD
>вставляет элемент в начало массива</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_prepend(​1, ARRAY[2,3])</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{1,2,3}</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_remove</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>, <TT
CLASS="TYPE"
>anyelement</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>anyarray</TT
>
                </TD
><TD
>удаляет из массива все элементы, равные заданному значению (массив должен быть одномерным)</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_remove(​ARRAY[1,2,3,2], 2)</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{1,3}</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_replace</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>, <TT
CLASS="TYPE"
>anyelement</TT
>, <TT
CLASS="TYPE"
>anyelement</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>anyarray</TT
>
                </TD
><TD
>заменяет в массиве все элементы, равные заданному значению, другим значением</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_replace(​ARRAY[1,2,5,4], 5, 3)</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{1,2,3,4}</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_to_string</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>, <TT
CLASS="TYPE"
>text</TT
> [<SPAN
CLASS="OPTIONAL"
>, <TT
CLASS="TYPE"
>text</TT
></SPAN
>])</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>text</TT
>
                </TD
><TD
>выводит элементы массива через заданный разделитель и позволяет определить замену для значения NULL</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_to_​string(​ARRAY[1, 2, 3, NULL, 5], ',', '*')</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>1,2,3,*,5</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>array_upper</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>, <TT
CLASS="TYPE"
>int</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>int</TT
>
                </TD
><TD
>возвращает верхнюю границу указанной размерности массива</TD
><TD
>                  <TT
CLASS="LITERAL"
>array_upper(​ARRAY[1,8,3,7], 1)</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>4</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>cardinality</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>int</TT
>
                </TD
><TD
>возвращает общее число элементов в массиве, либо 0, если массив пуст</TD
><TD
>                  <TT
CLASS="LITERAL"
>cardinality(​ARRAY[[1,2],[3,4]])</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>4</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>string_to_array</CODE
>(​<TT
CLASS="TYPE"
>text</TT
>, <TT
CLASS="TYPE"
>text</TT
> [<SPAN
CLASS="OPTIONAL"
>, <TT
CLASS="TYPE"
>text</TT
></SPAN
>])</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>text[]</TT
>
                </TD
><TD
>разбивает строку на элементы массива, используя заданный разделитель и, возможно, замену для значений NULL</TD
><TD
>                  <TT
CLASS="LITERAL"
>string_to_​array(​'xx~^~yy~​^~zz', '~^~', 'yy')</TT
>
                </TD
><TD
>                  <TT
CLASS="LITERAL"
>{xx,NULL,zz}</TT
>
                </TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>unnest</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>)</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>setof anyelement</TT
>
                </TD
><TD
>разворачивает массив в набор строк</TD
><TD
>                  <TT
CLASS="LITERAL"
>unnest(​ARRAY[1,2])</TT
>
                </TD
><TD
><PRE
CLASS="LITERALLAYOUT"
>1
2</PRE
>(2 строки)</TD
></TR
><TR
><TD
>         <TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>unnest</CODE
>(​<TT
CLASS="TYPE"
>anyarray</TT
>, <TT
CLASS="TYPE"
>anyarray</TT
> [, ...])</TT
>
        </TD
><TD
>                  <TT
CLASS="TYPE"
>setof anyelement, anyelement [, ...]</TT
>
                </TD
><TD
>разворачивает массивы (возможно разных типов) в набор строк. Это допускается только в предложении FROM; см. <A
HREF="queries-table-expressions.html#QUERIES-TABLEFUNCTIONS"
>Подраздел 7.2.1.4</A
></TD
><TD
>                  <TT
CLASS="LITERAL"
>unnest(ARRAY[1,2],ARRAY['foo','bar','baz'])</TT
>
                </TD
><TD
><PRE
CLASS="LITERALLAYOUT"
>1    foo
2    bar
NULL baz</PRE
>(3 строки)</TD
></TR
></TBODY
></TABLE
></DIV
><P
>Если для функции <CODE
CLASS="FUNCTION"
>string_to_array</CODE
> в качестве разделителя задан NULL, каждый символ входной строки станет отдельным элементов в полученном массиве. Если разделитель пустая строка, строка будет возвращена целиком в массиве из одного элемента. В противном случае входная строка разбивается по вхождениям подстроки, указанной в качестве разделителя.</P
><P
>Если для функции <CODE
CLASS="FUNCTION"
>string_to_array</CODE
> параметр замены значения NULL опущен или равен NULL, никакие подстроки во входных данных не будут заменяться на NULL. Если же параметр замены NULL опущен или равен NULL для функции <CODE
CLASS="FUNCTION"
>array_to_string</CODE
>, все значения NULL просто пропускаются и никак не представляются в выходной строке.</P
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>Замечание: </B
>В поведении <CODE
CLASS="FUNCTION"
>string_to_array</CODE
> по сравнению с <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> версий до 9.1 произошли два изменения. Во-первых, эта функция возвращает пустой массив (содержащий 0 элементов), а не NULL, когда входная строка имеет нулевую длину. Во-вторых, если в качестве разделителя задан NULL, эта функция разбивает строку по символам, а не просто возвращает NULL, как было раньше.</P
></BLOCKQUOTE
></DIV
><P
>Вы также можете узнать об агрегатной функции, работающей с массивами, <CODE
CLASS="FUNCTION"
>array_agg</CODE
> в <A
HREF="functions-aggregate.html"
>Разделе 9.20</A
>.</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="functions-conditional.html"
ACCESSKEY="P"
>Пред.</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Начало</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="functions-range.html"
ACCESSKEY="N"
>След.</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Условные выражения</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="functions.html"
ACCESSKEY="U"
>Уровень выше</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Диапазонные функции и операторы</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>